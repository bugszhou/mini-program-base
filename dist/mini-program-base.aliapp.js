!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("mipp"),require("mipp-ali"),require("lodash.get"),require("lodash.isequal")):"function"==typeof define&&define.amd?define(["exports","mipp","mipp-ali","lodash.get","lodash.isequal"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).miniProgramBase={},e.mipp,e.mippAli,e.get,e.isEqual)}(this,(function(e,t,n,o,r){"use strict";function i(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var a=i(o),p=i(r),u=function(e,t){return u=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},u(e,t)};function c(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}u(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}function l(e,t,n,o){var r,i=arguments.length,a=i<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,o);else for(var p=e.length-1;p>=0;p--)(r=e[p])&&(a=(i<3?r(a):i>3?r(t,n,a):r(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a}function s(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}function f(e,t,n,o){return new(n||(n=Promise))((function(r,i){function a(e){try{u(o.next(e))}catch(e){i(e)}}function p(e){try{u(o.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,p)}u((o=o.apply(e,t||[])).next())}))}function d(e,t){var n,o,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:p(0),throw:p(1),return:p(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function p(i){return function(p){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,o&&(r=2&i[0]?o.return:i[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,i[1])).done)return r;switch(o=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=a.trys,(r=r.length>0&&r[r.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],o=0}finally{n=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,p])}}}function y(e,t,n){if(n||2===arguments.length)for(var o,r=0,i=t.length;r<i;r++)!o&&r in t||(o||(o=Array.prototype.slice.call(t,0,r)),o[r]=t[r]);return e.concat(o||Array.prototype.slice.call(t))}var h,v=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.viewStatus="load",t}var o,r;return c(t,e),t.prototype.aom=function(){return this},t.prototype.isComponent=function(){return!0},t.prototype.isPage=function(){return!1},t.prototype.created=function(){for(var t,n=[],o=0;o<arguments.length;o++)n[o]=arguments[o];try{this.viewStatus="load",null===(t=e.prototype.created)||void 0===t||t.call.apply(t,y([this],n,!1))}catch(e){}},t.prototype.show=function(){for(var t,n=[],o=0;o<arguments.length;o++)n[o]=arguments[o];try{"ready"!==this.viewStatus&&(this.viewStatus="show"),null===(t=e.prototype.show)||void 0===t||t.call.apply(t,y([this],n,!1))}catch(e){}},t.prototype.ready=function(){for(var t,n=[],o=0;o<arguments.length;o++)n[o]=arguments[o];try{this.viewStatus="ready",null===(t=e.prototype.ready)||void 0===t||t.call.apply(t,y([this],n,!1))}catch(e){}},t.prototype.isReady=function(){return"ready"===(null==this?void 0:this.viewStatus)},t.prototype.getEvents=function(){throw new TypeError("需要在子类重写: getEvents 方法")},l([n.method,s("design:type",Function),s("design:paramtypes",[]),s("design:returntype","function"==typeof(o="undefined"!=typeof IComponent&&IComponent)?o:Object)],t.prototype,"aom",null),l([n.method,s("design:type",Function),s("design:paramtypes",[]),s("design:returntype",void 0)],t.prototype,"isComponent",null),l([n.method,s("design:type",Function),s("design:paramtypes",[]),s("design:returntype",void 0)],t.prototype,"isPage",null),l([n.lifetime,s("design:type",Function),s("design:paramtypes",[Object]),s("design:returntype",void 0)],t.prototype,"created",null),l([n.lifetime,s("design:type",Function),s("design:paramtypes",[Object]),s("design:returntype",void 0)],t.prototype,"show",null),l([n.lifetime,s("design:type",Function),s("design:paramtypes",[Object]),s("design:returntype",void 0)],t.prototype,"ready",null),l([n.method,s("design:type",Function),s("design:paramtypes",[]),s("design:returntype",void 0)],t.prototype,"isReady",null),l([n.method,s("design:type",Function),s("design:paramtypes",[]),s("design:returntype","function"==typeof(r="undefined"!=typeof IEvent&&IEvent)?r:Object)],t.prototype,"getEvents",null),t}(n.ComponentBase);function g(e){var t=e.context,n=e.subscribeMap,o=e.forceEmit,r=void 0!==o&&o,i=e.prevProps,u=void 0===i?{}:i,c=e.prevData,l=void 0===c?{}:c;Object.keys(n).forEach((function(e){var o,i=null==e?void 0:e.split(",").map((function(e){return null==e?void 0:e.replace(".**","").trim()})),c=null==i?void 0:i.map((function(e){if(!e)return{value:void 0,changed:!1,type:h.UNKNOWN};if("**"===e)return{value:void 0,changed:!0,type:h.ALL};var n=a.default(u,e),o=a.default(null==t?void 0:t.props,e),r=a.default(l,e),i=a.default(null==t?void 0:t.data,e);if(!p.default(n,o))return{value:o,changed:!0,type:h.PROPS};if(!p.default(r,i))return{value:i,changed:!0,type:h.DATA};var c=h.UNKNOWN,s=void 0;return void 0!==o?(c=h.PROPS,s=o):void 0!==i&&(c=h.DATA,s=i),{value:s,changed:!1,type:c}}));!r&&c.every((function(e){return!(null==e?void 0:e.changed)}))||null===(o=n[e])||void 0===o||o.forEach((function(e){var n;null===(n=null==e?void 0:e.call)||void 0===n||n.call.apply(n,y(y([e,t],c.map((function(e){return null==e?void 0:e.value})),!1),c.map((function(e){return null==e?void 0:e.type})),!1))}))}))}!function(e){e.DATA="data",e.PROPS="props",e.ALL="all",e.UNKNOWN="unknown"}(h||(h={}));var m=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.viewStatus="load",t}return c(t,e),t.prototype.isComponent=function(){return!1},t.prototype.isPage=function(){return!0},t.prototype.onLoad=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];try{this.viewStatus="load","function"==typeof e.prototype.onLoad&&e.prototype.onLoad.apply(this,t)}catch(e){}},t.prototype.onShow=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];try{"ready"!==this.viewStatus&&(this.viewStatus="show"),"function"==typeof e.prototype.onShow&&e.prototype.onShow.apply(this,t)}catch(e){}},t.prototype.onReady=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];try{this.viewStatus="ready","function"==typeof e.prototype.onReady&&e.prototype.onReady.apply(this,t)}catch(e){}},t.prototype.isReady=function(){return"ready"===(null==this?void 0:this.viewStatus)},t.prototype.getEvents=function(){throw new TypeError("需要在子类重写: getEvents 方法")},t}(n.MiniPage);Object.defineProperty(e,"WeappMiniComponent",{enumerable:!0,get:function(){return t.MiniComponent}}),Object.defineProperty(e,"WeappPageBase",{enumerable:!0,get:function(){return t.PageBase}}),Object.defineProperty(e,"AliMiniComponent",{enumerable:!0,get:function(){return n.MiniComponent}}),Object.defineProperty(e,"MiniComponent",{enumerable:!0,get:function(){return n.MiniComponent}}),Object.defineProperty(e,"lifetimes",{enumerable:!0,get:function(){return n.lifetimes}}),Object.defineProperty(e,"method",{enumerable:!0,get:function(){return n.method}}),Object.defineProperty(e,"pageLifetime",{enumerable:!0,get:function(){return n.pageLifetime}}),e.AliappPageBase=m,e.ComponentBase=v,e.MiniProgramComponent=function(e){var t=new e;n.ComponentBase.render(t)},e.MiniProgramPage=function(e){var t=new e;t.__serialNumber=Date.now().toString(32)+Math.random().toString(32).substring(2),n.MiniPage.render(t)},e.PageBase=m,e.observer=function(e){return function(t,n,o){var r=o.value,i=e||n;if(!t._propsSubscribeMap){t._propsSubscribeMap={};var a=t.didMount;t.didMount=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];return f(this,void 0,void 0,(function(){return d(this,(function(n){switch(n.label){case 0:return n.trys.push([0,3,,4]),g({context:this,subscribeMap:t._propsSubscribeMap||{},forceEmit:!0}),"function"!=typeof a?[3,2]:[4,a.call.apply(a,y([this],e,!1))];case 1:return[2,n.sent()];case 2:return[3,4];case 3:throw n.sent();case 4:return[2]}}))}))};var p=t.didUpdate;t.didUpdate=function(e,n){return f(this,void 0,void 0,(function(){return d(this,(function(o){switch(o.label){case 0:return o.trys.push([0,3,,4]),g({context:this,subscribeMap:t._propsSubscribeMap||{},forceEmit:!1,prevProps:e,prevData:n}),"function"!=typeof p?[3,2]:[4,p.call(this,e,n)];case 1:return[2,o.sent()];case 2:return[3,4];case 3:throw o.sent();case 4:return[2]}}))}))}}t._propsSubscribeMap[i]||(t._propsSubscribeMap[i]=[]),t._propsSubscribeMap[i].push(r)}},Object.defineProperty(e,"__esModule",{value:!0})}));//# sourceMappingURL=mini-program-base.aliapp.js.map
