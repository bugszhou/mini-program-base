{"version":3,"file":"mini-program-base.js","sources":["../src/ComponentBase.ts","../src/index.ts","../src/Decorators/Component.ts","../src/Decorators/Page.ts","../src/helps/index.ts"],"sourcesContent":["import {\n  MiniComponent,\n  method,\n  ComponentBase as MiniComponentBase,\n  lifetimes,\n} from \"mipp\";\nimport { IEventBase } from \"./Decorators/events\";\n\nexport default class ComponentBase<\n  IData = any,\n> extends MiniComponentBase<IData> {\n  viewStatus: \"load\" | \"show\" | \"ready\" = \"load\";\n\n  @method\n  aom<IComponent = MiniComponent<any>>(): IComponent {\n    return this as unknown as IComponent;\n  }\n\n  @lifetimes\n  created(...opts: any) {\n    try {\n      this.viewStatus = \"load\";\n      if (typeof super.created === \"function\") {\n        // eslint-disable-next-line @typescript-eslint/ban-ts-comment\n        // @ts-ignore\n        super.created(...opts);\n      }\n    } catch {}\n  }\n\n  @lifetimes\n  show(...opts: any) {\n    try {\n      if (this.viewStatus !== \"ready\") {\n        this.viewStatus = \"show\";\n      }\n      if (typeof super.show === \"function\") {\n        // eslint-disable-next-line @typescript-eslint/ban-ts-comment\n        // @ts-ignore\n        super.show(...opts);\n      }\n    } catch {}\n  }\n\n  @lifetimes\n  ready(...opts: any) {\n    try {\n      this.viewStatus = \"ready\";\n      if (typeof super.ready === \"function\") {\n        // eslint-disable-next-line @typescript-eslint/ban-ts-comment\n        // @ts-ignore\n        super.ready(...opts);\n      }\n    } catch {}\n  }\n\n  /**\n   * 视图是否准备完成\n   * @returns boolean\n   */\n  @method\n  isReady() {\n    return this?.viewStatus === \"ready\";\n  }\n\n  @method\n  getEvents<IEvent = IEventBase>(): IEvent {\n    throw new TypeError(\"需要在子类重写: getEvents 方法\");\n  }\n}\n\nexport { MiniComponent };\n","import {\n  IComponentData,\n  MiniComponent as WeappMiniComponent,\n  method,\n  pageLifetime,\n  lifetimes,\n  observer as weappObserver,\n  IMiniEvent,\n  IMiniComponentOptions,\n  PageBase,\n} from \"mipp\";\nimport {\n  MiniComponent as AliMiniComponent,\n  PageBase as AliappPageBase,\n} from \"mipp-ali\";\nimport ComponentBase from \"./ComponentBase\";\nimport { IEventBase } from \"./Decorators/events\";\nexport * from \"./Decorators/index\";\n\n// eslint-disable-next-line @typescript-eslint/no-unused-vars\nfunction observer(key?: string) {\n  return weappObserver;\n}\n\nclass ViewBase<IData extends Record<string, any>> extends PageBase<IData> {\n  viewStatus: \"load\" | \"show\" | \"ready\" = \"load\";\n\n  onLoad(...opts: any) {\n    try {\n      this.viewStatus = \"load\";\n      if (typeof super.onLoad === \"function\") {\n        // eslint-disable-next-line @typescript-eslint/ban-ts-comment\n        // @ts-ignore\n        super.onLoad(...opts);\n      }\n    } catch {}\n  }\n\n  onShow(...opts: any) {\n    try {\n      if (this.viewStatus !== \"ready\") {\n        this.viewStatus = \"show\";\n      }\n      if (typeof super.onShow === \"function\") {\n        // eslint-disable-next-line @typescript-eslint/ban-ts-comment\n        // @ts-ignore\n        super.onShow(...opts);\n      }\n    } catch {}\n  }\n\n  onReady(...opts: any) {\n    try {\n      this.viewStatus = \"ready\";\n      if (typeof super.onReady === \"function\") {\n        // eslint-disable-next-line @typescript-eslint/ban-ts-comment\n        // @ts-ignore\n        super.onReady(...opts);\n      }\n    } catch {}\n  }\n\n  /**\n   * 视图是否准备完成\n   * @returns boolean\n   */\n  isReady() {\n    return this?.viewStatus === \"ready\";\n  }\n\n  getEvents<IEvent = IEventBase>(): IEvent {\n    throw new TypeError(\"需要在子类重写: getEvents 方法\");\n  }\n}\n\nexport {\n  ComponentBase,\n  WeappMiniComponent as MiniComponent,\n  WeappMiniComponent,\n  AliMiniComponent,\n  IComponentData,\n  observer,\n  method,\n  pageLifetime,\n  lifetimes,\n  IMiniEvent,\n  IMiniComponentOptions,\n  ViewBase as PageBase,\n  ViewBase as WeappPageBase,\n  AliappPageBase,\n};\n","import { ComponentBase } from \"mipp\";\n\nexport default function MiniProgramComponent(target: new (...opts: any[]) => any) {\n  const obj = new target();\n  ComponentBase.render(obj);\n}\n","import { PageBase } from \"mipp\";\nimport { generateRandomString } from \"../helps\";\n\nexport default function MiniProgramPage(target: new (...opts: any[]) => any) {\n  const obj = new target();\n  obj.__serialNumber = generateRandomString();\n  PageBase.render(obj);\n}\n","export function generateRandomString() {\n  return Date.now().toString(32) + Math.random().toString(32).substring(2);\n}\n"],"names":["ComponentBase","_super","_this","apply","this","arguments","viewStatus","__extends","prototype","aom","created","opts","_i","length","_a","show","ready","isReady","getEvents","TypeError","__decorate","method","__metadata","IComponent","Object","lifetimes","_b","IEvent","MiniComponentBase","ViewBase","onLoad","onShow","onReady","PageBase","defineProperty","exports","enumerable","get","mipp","MiniComponent","pageLifetime","mippAli","MiniProgramComponent","target","obj","render","MiniProgramPage","__serialNumber","Date","now","toString","Math","random","substring","WeappPageBase","observer","key","weappObserver","value"],"mappings":"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"}