{"version":3,"file":"mini-program-base.js","sources":["../src/ComponentBase.ts","../src/index.ts","../src/Decorators/Component.ts","../src/Decorators/Page.ts","../src/helps/index.ts"],"sourcesContent":["import {\n  MiniComponent,\n  method,\n  ComponentBase as MiniComponentBase,\n} from \"mipp\";\nimport { IEventBase } from \"./Decorators/events\";\n\nMiniComponentBase.before = () => {\n  return ComponentBase?.before?.() ?? Object.create(null);\n};\n\nexport default class ComponentBase<\n  IData = any,\n> extends MiniComponentBase<IData> {\n  viewStatus: \"load\" | \"ready\" = \"load\";\n\n  protected pageViewIns: any = null;\n\n  static before(): {\n    created: () => void;\n    ready: () => void;\n  } {\n    return Object.create(null);\n  }\n\n  @method\n  aom<IComponent = MiniComponent<any>>(): IComponent {\n    return this as unknown as IComponent;\n  }\n\n  @method\n  isComponent() {\n    return true;\n  }\n\n  @method\n  isPage() {\n    return false;\n  }\n\n  @method\n  getPageViewIns() {\n    return this?.pageViewIns ?? null;\n  }\n\n  /**\n   * 视图是否准备完成\n   * @returns boolean\n   */\n  @method\n  isReady() {\n    return this?.viewStatus === \"ready\";\n  }\n\n  @method\n  getEvents<IEvent = IEventBase>(): IEvent {\n    throw new TypeError(\"需要在子类重写: getEvents 方法\");\n  }\n}\n\nexport { MiniComponent };\n","import {\n  IComponentData,\n  MiniComponent as WeappMiniComponent,\n  method,\n  pageLifetime,\n  lifetimes,\n  lifetime,\n  observer as weappObserver,\n  IMiniEvent,\n  IMiniComponentOptions,\n  PageBase,\n  extendLifetime,\n} from \"mipp\";\nimport {\n  MiniComponent as AliMiniComponent,\n  PageBase as AliappPageBase,\n} from \"mipp-ali\";\nimport ComponentBase from \"./ComponentBase\";\nimport { IEventBase } from \"./Decorators/events\";\nexport * from \"./Decorators/index\";\n\n// eslint-disable-next-line @typescript-eslint/no-unused-vars\nfunction observer(key?: string) {\n  return weappObserver;\n}\n\nPageBase.before = () => {\n  return ViewBase?.before?.() ?? Object.create(null);\n};\n\nclass ViewBase<\n  IData extends Record<string, any>,\n  IOptions = any,\n> extends PageBase<IData> {\n  viewStatus: \"load\" | \"show\" | \"ready\" = \"load\";\n\n  protected myComponents: any[] = [];\n\n  // eslint-disable-next-line @typescript-eslint/ban-ts-comment\n  // @ts-ignore\n  protected viewOptions: IOptions = {};\n\n  static before(): {\n    onLoad: () => void;\n    onShow: () => void;\n    onReady: () => void;\n  } {\n    return Object.create(null);\n  }\n\n  isComponent() {\n    return false;\n  }\n\n  isPage() {\n    return true;\n  }\n\n  getComponents() {\n    return this?.myComponents ?? [];\n  }\n\n  getViewOptions(): IOptions {\n    return this.viewOptions ?? Object.create(null);\n  }\n\n  /**\n   * 视图是否准备完成\n   * @returns boolean\n   */\n  isReady() {\n    return this?.viewStatus === \"ready\";\n  }\n\n  getEvents<IEvent = IEventBase>(): IEvent {\n    throw new TypeError(\"需要在子类重写: getEvents 方法\");\n  }\n\n  beforeOnLoad(...opts: any[]) {\n    try {\n      this.viewOptions = opts?.[0] ?? Object.create(null);\n      // eslint-disable-next-line @typescript-eslint/ban-ts-comment\n      // @ts-ignore\n      super.beforeOnLoad?.(...opts);\n    } catch {}\n  }\n}\n\nexport {\n  ComponentBase,\n  WeappMiniComponent as MiniComponent,\n  WeappMiniComponent,\n  AliMiniComponent,\n  IComponentData,\n  observer,\n  method,\n  pageLifetime,\n  lifetimes,\n  lifetime,\n  extendLifetime,\n  IMiniEvent,\n  IMiniComponentOptions,\n  ViewBase as PageBase,\n  ViewBase as WeappPageBase,\n  AliappPageBase,\n};\n","import { ComponentBase } from \"mipp\";\n\nexport default function MiniProgramComponent(target: new (...opts: any[]) => any) {\n  const obj = new target();\n  ComponentBase.render(obj);\n}\n","import { PageBase } from \"mipp\";\nimport { generateRandomString } from \"../helps\";\n\nexport default function MiniProgramPage(target: new (...opts: any[]) => any) {\n  const obj = new target();\n  obj.__serialNumber = generateRandomString();\n  PageBase.render(obj);\n}\n","export function generateRandomString() {\n  return Date.now().toString(32) + Math.random().toString(32).substring(2);\n}\n"],"names":["MiniComponentBase","ComponentBase","before","_a","call","Object","create","_super","_this","apply","this","arguments","viewStatus","pageViewIns","__extends","prototype","aom","isComponent","isPage","getPageViewIns","isReady","getEvents","TypeError","__decorate","method","__metadata","IComponent","_b","IEvent","PageBase","ViewBase","myComponents","viewOptions","getComponents","getViewOptions","beforeOnLoad","opts","_i","length","__spreadArray","_c","defineProperty","exports","enumerable","get","mipp","MiniComponent","extendLifetime","lifetime","lifetimes","pageLifetime","mippAli","MiniProgramComponent","target","obj","render","MiniProgramPage","__serialNumber","Date","now","toString","Math","random","substring","WeappPageBase","observer","key","weappObserver","value"],"mappings":"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"}