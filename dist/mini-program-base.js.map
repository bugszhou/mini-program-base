{"version":3,"file":"mini-program-base.js","sources":["../src/ComponentBase.ts","../src/index.ts","../src/Decorators/Component.ts","../src/Decorators/Page.ts","../src/helps/index.ts"],"sourcesContent":["import {\n  MiniComponent,\n  method,\n  ComponentBase as MiniComponentBase,\n  lifetime,\n} from \"mipp\";\nimport { IEventBase } from \"./Decorators/events\";\n\nexport default class ComponentBase<\n  IData = any,\n> extends MiniComponentBase<IData> {\n  viewStatus: \"load\" | \"show\" | \"ready\" = \"load\";\n\n  @method\n  aom<IComponent = MiniComponent<any>>(): IComponent {\n    return this as unknown as IComponent;\n  }\n\n  @lifetime\n  created(...opts: any) {\n    try {\n      this.viewStatus = \"load\";\n      // eslint-disable-next-line @typescript-eslint/ban-ts-comment\n      // @ts-ignore\n      super.created?.(...opts);\n    } catch {}\n  }\n\n  @lifetime\n  show(...opts: any) {\n    try {\n      if (this.viewStatus !== \"ready\") {\n        this.viewStatus = \"show\";\n      }\n      // eslint-disable-next-line @typescript-eslint/ban-ts-comment\n      // @ts-ignore\n      super.show?.(...opts);\n    } catch {}\n  }\n\n  @lifetime\n  ready(...opts: any) {\n    try {\n      this.viewStatus = \"ready\";\n      // eslint-disable-next-line @typescript-eslint/ban-ts-comment\n      // @ts-ignore\n      super.ready?.(...opts);\n    } catch {}\n  }\n\n  /**\n   * 视图是否准备完成\n   * @returns boolean\n   */\n  @method\n  isReady() {\n    return this?.viewStatus === \"ready\";\n  }\n\n  @method\n  getEvents<IEvent = IEventBase>(): IEvent {\n    throw new TypeError(\"需要在子类重写: getEvents 方法\");\n  }\n}\n\nexport { MiniComponent };\n","import {\n  IComponentData,\n  MiniComponent as WeappMiniComponent,\n  method,\n  pageLifetime,\n  lifetimes,\n  observer as weappObserver,\n  IMiniEvent,\n  IMiniComponentOptions,\n  PageBase,\n} from \"mipp\";\nimport {\n  MiniComponent as AliMiniComponent,\n  PageBase as AliappPageBase,\n} from \"mipp-ali\";\nimport ComponentBase from \"./ComponentBase\";\nimport { IEventBase } from \"./Decorators/events\";\nexport * from \"./Decorators/index\";\n\n// eslint-disable-next-line @typescript-eslint/no-unused-vars\nfunction observer(key?: string) {\n  return weappObserver;\n}\n\nclass ViewBase<IData extends Record<string, any>> extends PageBase<IData> {\n  viewStatus: \"load\" | \"show\" | \"ready\" = \"load\";\n\n  onLoad(...opts: any) {\n    try {\n      this.viewStatus = \"load\";\n      if (typeof super.onLoad === \"function\") {\n        // eslint-disable-next-line @typescript-eslint/ban-ts-comment\n        // @ts-ignore\n        super.onLoad(...opts);\n      }\n    } catch {}\n  }\n\n  onShow(...opts: any) {\n    try {\n      if (this.viewStatus !== \"ready\") {\n        this.viewStatus = \"show\";\n      }\n      if (typeof super.onShow === \"function\") {\n        // eslint-disable-next-line @typescript-eslint/ban-ts-comment\n        // @ts-ignore\n        super.onShow(...opts);\n      }\n    } catch {}\n  }\n\n  onReady(...opts: any) {\n    try {\n      this.viewStatus = \"ready\";\n      if (typeof super.onReady === \"function\") {\n        // eslint-disable-next-line @typescript-eslint/ban-ts-comment\n        // @ts-ignore\n        super.onReady(...opts);\n      }\n    } catch {}\n  }\n\n  /**\n   * 视图是否准备完成\n   * @returns boolean\n   */\n  isReady() {\n    return this?.viewStatus === \"ready\";\n  }\n\n  getEvents<IEvent = IEventBase>(): IEvent {\n    throw new TypeError(\"需要在子类重写: getEvents 方法\");\n  }\n}\n\nexport {\n  ComponentBase,\n  WeappMiniComponent as MiniComponent,\n  WeappMiniComponent,\n  AliMiniComponent,\n  IComponentData,\n  observer,\n  method,\n  pageLifetime,\n  lifetimes,\n  IMiniEvent,\n  IMiniComponentOptions,\n  ViewBase as PageBase,\n  ViewBase as WeappPageBase,\n  AliappPageBase,\n};\n","import { ComponentBase } from \"mipp\";\n\nexport default function MiniProgramComponent(target: new (...opts: any[]) => any) {\n  const obj = new target();\n  ComponentBase.render(obj);\n}\n","import { PageBase } from \"mipp\";\nimport { generateRandomString } from \"../helps\";\n\nexport default function MiniProgramPage(target: new (...opts: any[]) => any) {\n  const obj = new target();\n  obj.__serialNumber = generateRandomString();\n  PageBase.render(obj);\n}\n","export function generateRandomString() {\n  return Date.now().toString(32) + Math.random().toString(32).substring(2);\n}\n"],"names":["ComponentBase","_super","_this","apply","this","arguments","viewStatus","__extends","prototype","aom","created","opts","_i","length","_a","call","__spreadArray","_b","show","ready","isReady","getEvents","TypeError","__decorate","method","__metadata","IComponent","Object","lifetime","IEvent","MiniComponentBase","ViewBase","onLoad","onShow","onReady","PageBase","defineProperty","exports","enumerable","get","mipp","MiniComponent","lifetimes","pageLifetime","mippAli","MiniProgramComponent","target","obj","render","MiniProgramPage","__serialNumber","Date","now","toString","Math","random","substring","WeappPageBase","observer","key","weappObserver","value"],"mappings":"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"}