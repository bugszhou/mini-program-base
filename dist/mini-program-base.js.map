{"version":3,"file":"mini-program-base.js","sources":["../src/ComponentBase.ts","../src/index.ts","../src/Decorators/Component.ts","../src/Decorators/Page.ts","../src/helps/index.ts"],"sourcesContent":["import {\n  MiniComponent,\n  method,\n  ComponentBase as MiniComponentBase,\n  lifetime,\n} from \"mipp\";\nimport { IEventBase } from \"./Decorators/events\";\n\nexport default class ComponentBase<\n  IData = any,\n> extends MiniComponentBase<IData> {\n  viewStatus: \"load\" | \"show\" | \"ready\" = \"load\";\n\n  @method\n  aom<IComponent = MiniComponent<any>>(): IComponent {\n    return this as unknown as IComponent;\n  }\n\n  @method\n  isComponent() {\n    return true;\n  }\n\n  @method\n  isPage() {\n    return false;\n  }\n\n  @lifetime\n  created(...opts: any) {\n    try {\n      this.viewStatus = \"load\";\n      // eslint-disable-next-line @typescript-eslint/ban-ts-comment\n      // @ts-ignore\n      super.created?.(...opts);\n    } catch {}\n  }\n\n  @lifetime\n  show(...opts: any) {\n    try {\n      if (this.viewStatus !== \"ready\") {\n        this.viewStatus = \"show\";\n      }\n      // eslint-disable-next-line @typescript-eslint/ban-ts-comment\n      // @ts-ignore\n      super.show?.(...opts);\n    } catch {}\n  }\n\n  @lifetime\n  ready(...opts: any) {\n    try {\n      this.viewStatus = \"ready\";\n      // eslint-disable-next-line @typescript-eslint/ban-ts-comment\n      // @ts-ignore\n      super.ready?.(...opts);\n    } catch {}\n  }\n\n  /**\n   * 视图是否准备完成\n   * @returns boolean\n   */\n  @method\n  isReady() {\n    return this?.viewStatus === \"ready\";\n  }\n\n  @method\n  getEvents<IEvent = IEventBase>(): IEvent {\n    throw new TypeError(\"需要在子类重写: getEvents 方法\");\n  }\n}\n\nexport { MiniComponent };\n","import {\n  IComponentData,\n  MiniComponent as WeappMiniComponent,\n  method,\n  pageLifetime,\n  lifetimes,\n  observer as weappObserver,\n  IMiniEvent,\n  IMiniComponentOptions,\n  PageBase,\n} from \"mipp\";\nimport {\n  MiniComponent as AliMiniComponent,\n  PageBase as AliappPageBase,\n} from \"mipp-ali\";\nimport ComponentBase from \"./ComponentBase\";\nimport { IEventBase } from \"./Decorators/events\";\nexport * from \"./Decorators/index\";\n\n// eslint-disable-next-line @typescript-eslint/no-unused-vars\nfunction observer(key?: string) {\n  return weappObserver;\n}\n\nclass ViewBase<IData extends Record<string, any>> extends PageBase<IData> {\n  viewStatus: \"load\" | \"show\" | \"ready\" = \"load\";\n\n  isComponent() {\n    return false;\n  }\n\n  isPage() {\n    return true;\n  }\n\n  onLoad(...opts: any) {\n    try {\n      this.viewStatus = \"load\";\n      if (typeof super.onLoad === \"function\") {\n        // eslint-disable-next-line @typescript-eslint/ban-ts-comment\n        // @ts-ignore\n        super.onLoad(...opts);\n      }\n    } catch {}\n  }\n\n  onShow(...opts: any) {\n    try {\n      if (this.viewStatus !== \"ready\") {\n        this.viewStatus = \"show\";\n      }\n      if (typeof super.onShow === \"function\") {\n        // eslint-disable-next-line @typescript-eslint/ban-ts-comment\n        // @ts-ignore\n        super.onShow(...opts);\n      }\n    } catch {}\n  }\n\n  onReady(...opts: any) {\n    try {\n      this.viewStatus = \"ready\";\n      if (typeof super.onReady === \"function\") {\n        // eslint-disable-next-line @typescript-eslint/ban-ts-comment\n        // @ts-ignore\n        super.onReady(...opts);\n      }\n    } catch {}\n  }\n\n  /**\n   * 视图是否准备完成\n   * @returns boolean\n   */\n  isReady() {\n    return this?.viewStatus === \"ready\";\n  }\n\n  getEvents<IEvent = IEventBase>(): IEvent {\n    throw new TypeError(\"需要在子类重写: getEvents 方法\");\n  }\n}\n\nexport {\n  ComponentBase,\n  WeappMiniComponent as MiniComponent,\n  WeappMiniComponent,\n  AliMiniComponent,\n  IComponentData,\n  observer,\n  method,\n  pageLifetime,\n  lifetimes,\n  IMiniEvent,\n  IMiniComponentOptions,\n  ViewBase as PageBase,\n  ViewBase as WeappPageBase,\n  AliappPageBase,\n};\n","import { ComponentBase } from \"mipp\";\n\nexport default function MiniProgramComponent(target: new (...opts: any[]) => any) {\n  const obj = new target();\n  ComponentBase.render(obj);\n}\n","import { PageBase } from \"mipp\";\nimport { generateRandomString } from \"../helps\";\n\nexport default function MiniProgramPage(target: new (...opts: any[]) => any) {\n  const obj = new target();\n  obj.__serialNumber = generateRandomString();\n  PageBase.render(obj);\n}\n","export function generateRandomString() {\n  return Date.now().toString(32) + Math.random().toString(32).substring(2);\n}\n"],"names":["ComponentBase","_super","_this","apply","this","arguments","viewStatus","__extends","prototype","aom","isComponent","isPage","created","opts","_i","length","_a","call","__spreadArray","_b","show","ready","isReady","getEvents","TypeError","__decorate","method","__metadata","IComponent","Object","lifetime","IEvent","MiniComponentBase","ViewBase","onLoad","onShow","onReady","PageBase","defineProperty","exports","enumerable","get","mipp","MiniComponent","lifetimes","pageLifetime","mippAli","MiniProgramComponent","target","obj","render","MiniProgramPage","__serialNumber","Date","now","toString","Math","random","substring","WeappPageBase","observer","key","weappObserver","value"],"mappings":"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"}