{"version":3,"file":"mini-program-base.es.js","sources":["../src/ComponentBase.ts","../src/helps/index.ts","../src/Decorators/Page.ts","../src/Decorators/Component.ts","../src/index.ts"],"sourcesContent":["import {\n  MiniComponent,\n  method,\n  ComponentBase as MiniComponentBase,\n  lifetime,\n} from \"mipp\";\nimport { IEventBase } from \"./Decorators/events\";\n\nexport default class ComponentBase<\n  IData = any,\n> extends MiniComponentBase<IData> {\n  viewStatus: \"load\" | \"show\" | \"ready\" = \"load\";\n\n  @method\n  aom<IComponent = MiniComponent<any>>(): IComponent {\n    return this as unknown as IComponent;\n  }\n\n  @method\n  isComponent() {\n    return true;\n  }\n\n  @method\n  isPage() {\n    return false;\n  }\n\n  @lifetime\n  created(...opts: any) {\n    try {\n      this.viewStatus = \"load\";\n      // eslint-disable-next-line @typescript-eslint/ban-ts-comment\n      // @ts-ignore\n      super.created?.(...opts);\n    } catch {}\n  }\n\n  @lifetime\n  show(...opts: any) {\n    try {\n      if (this.viewStatus !== \"ready\") {\n        this.viewStatus = \"show\";\n      }\n      // eslint-disable-next-line @typescript-eslint/ban-ts-comment\n      // @ts-ignore\n      super.show?.(...opts);\n    } catch {}\n  }\n\n  @lifetime\n  ready(...opts: any) {\n    try {\n      this.viewStatus = \"ready\";\n      // eslint-disable-next-line @typescript-eslint/ban-ts-comment\n      // @ts-ignore\n      super.ready?.(...opts);\n    } catch {}\n  }\n\n  /**\n   * 视图是否准备完成\n   * @returns boolean\n   */\n  @method\n  isReady() {\n    return this?.viewStatus === \"ready\";\n  }\n\n  @method\n  getEvents<IEvent = IEventBase>(): IEvent {\n    throw new TypeError(\"需要在子类重写: getEvents 方法\");\n  }\n}\n\nexport { MiniComponent };\n","export function generateRandomString() {\n  return Date.now().toString(32) + Math.random().toString(32).substring(2);\n}\n","import { PageBase } from \"mipp\";\nimport { generateRandomString } from \"../helps\";\n\nexport default function MiniProgramPage(target: new (...opts: any[]) => any) {\n  const obj = new target();\n  obj.__serialNumber = generateRandomString();\n  PageBase.render(obj);\n}\n","import { ComponentBase } from \"mipp\";\n\nexport default function MiniProgramComponent(target: new (...opts: any[]) => any) {\n  const obj = new target();\n  ComponentBase.render(obj);\n}\n","import {\n  IComponentData,\n  MiniComponent as WeappMiniComponent,\n  method,\n  pageLifetime,\n  lifetimes,\n  observer as weappObserver,\n  IMiniEvent,\n  IMiniComponentOptions,\n  PageBase,\n} from \"mipp\";\nimport {\n  MiniComponent as AliMiniComponent,\n  PageBase as AliappPageBase,\n} from \"mipp-ali\";\nimport ComponentBase from \"./ComponentBase\";\nimport { IEventBase } from \"./Decorators/events\";\nexport * from \"./Decorators/index\";\n\n// eslint-disable-next-line @typescript-eslint/no-unused-vars\nfunction observer(key?: string) {\n  return weappObserver;\n}\n\nclass ViewBase<IData extends Record<string, any>> extends PageBase<IData> {\n  viewStatus: \"load\" | \"show\" | \"ready\" = \"load\";\n\n  isComponent() {\n    return false;\n  }\n\n  isPage() {\n    return true;\n  }\n\n  onLoad(...opts: any) {\n    try {\n      this.viewStatus = \"load\";\n      if (typeof super.onLoad === \"function\") {\n        // eslint-disable-next-line @typescript-eslint/ban-ts-comment\n        // @ts-ignore\n        super.onLoad(...opts);\n      }\n    } catch {}\n  }\n\n  onShow(...opts: any) {\n    try {\n      if (this.viewStatus !== \"ready\") {\n        this.viewStatus = \"show\";\n      }\n      if (typeof super.onShow === \"function\") {\n        // eslint-disable-next-line @typescript-eslint/ban-ts-comment\n        // @ts-ignore\n        super.onShow(...opts);\n      }\n    } catch {}\n  }\n\n  onReady(...opts: any) {\n    try {\n      this.viewStatus = \"ready\";\n      if (typeof super.onReady === \"function\") {\n        // eslint-disable-next-line @typescript-eslint/ban-ts-comment\n        // @ts-ignore\n        super.onReady(...opts);\n      }\n    } catch {}\n  }\n\n  /**\n   * 视图是否准备完成\n   * @returns boolean\n   */\n  isReady() {\n    return this?.viewStatus === \"ready\";\n  }\n\n  getEvents<IEvent = IEventBase>(): IEvent {\n    throw new TypeError(\"需要在子类重写: getEvents 方法\");\n  }\n}\n\nexport {\n  ComponentBase,\n  WeappMiniComponent as MiniComponent,\n  WeappMiniComponent,\n  AliMiniComponent,\n  IComponentData,\n  observer,\n  method,\n  pageLifetime,\n  lifetimes,\n  IMiniEvent,\n  IMiniComponentOptions,\n  ViewBase as PageBase,\n  ViewBase as WeappPageBase,\n  AliappPageBase,\n};\n"],"names":["MiniComponentBase","ComponentBase","weappObserver"],"mappings":"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"}